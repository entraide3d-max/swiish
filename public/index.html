<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#020617" />
    <link rel="manifest" id="pwa-manifest" href="%PUBLIC_URL%/manifest.json" />
    <link rel="apple-touch-icon" sizes="180x180" href="%PUBLIC_URL%/icons/icon-192.png" />
    <script>
      // Update manifest link immediately based on URL slug (before React loads)
      (function() {
        const path = window.location.pathname || '';
        const slug = path.replace(/^\//, '').split('/')[0]; // Get first path segment
        if (slug && slug !== 'admin' && slug !== '') {
          const manifestLink = document.getElementById('pwa-manifest') || document.querySelector('link[rel="manifest"]');
          if (manifestLink) {
            const newHref = '/manifest/' + slug + '.json';
            manifestLink.setAttribute('href', newHref);
            // Only log in development (localhost)
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
              console.log('[PWA Debug] Updated manifest link to:', newHref, 'for slug:', slug);
            }
          } else {
            // Only log in development (localhost)
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
              console.warn('[PWA Debug] Manifest link not found in DOM');
            }
          }
        } else {
          // Only log in development (localhost)
          if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            console.log('[PWA Debug] No slug found or admin page, keeping default manifest');
          }
        }
      })();
    </script>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>Swiish</title>
    <!-- Inline theme pre-load to avoid flash of incorrect theme -->
    <script>
      (function() {
        const stored = localStorage.getItem('darkMode');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const shouldBeDark = stored === 'true' || (stored === null && prefersDark);
        if (shouldBeDark) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      })();
    </script>
    <style>
      /* Hide scrollbar for Chrome, Safari and Opera */
      .scrollbar-hide::-webkit-scrollbar { display: none; }
      /* Hide scrollbar for IE, Edge and Firefox */
      .scrollbar-hide { -ms-overflow-style: none;  scrollbar-width: none; }
      /* Animation Utilities */
      .animate-in { animation: animate-in 0.5s ease-out forwards; }
      @keyframes animate-in { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>
